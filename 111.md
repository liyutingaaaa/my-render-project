# 热点资讯汇 - UML 设计图

## 1. 系统架构类图

```mermaid
classDiagram
    class App {
        +Router
        +Header
        +Routes
        +Toaster
    }
    
    class Header {
        +logo: ReactNode
        +ModeToggle
        +render()
    }
    
    class HomePage {
        -selectedCategory: NewsCategory
        -timeFilter: TimeFilter
        -searchQuery: string
        -newsList: NewsItem[]
        -loading: boolean
        +fetchNews()
        +handleSearch()
        +handleNewsClick()
        +render()
    }
    
    class NewsDetailPage {
        -news: NewsItem
        -summary: string
        -loadingSummary: boolean
        +fetchSummary()
        +handleShare()
        +render()
    }
    
    class CategorySidebar {
        -selectedCategory: NewsCategory
        +onCategoryChange()
        +render()
    }
    
    class SearchBar {
        -query: string
        +onSearch()
        +handleSubmit()
        +render()
    }
    
    class FilterBar {
        -timeFilter: TimeFilter
        +onTimeFilterChange()
        +render()
    }
    
    class NewsCard {
        -news: NewsItem
        +onClick()
        +formatDate()
        +render()
    }
    
    class API {
        +searchNews(request: SearchRequest)
        +summarizeWeb(request: WebSummaryRequest)
    }
    
    class NewsItem {
        +id: number
        +title: string
        +content: string
        +url: string
        +date: string
        +category: string
        +source: string
        +image?: string
        +summary?: string
    }
    
    class SearchRequest {
        +messages: SearchMessage[]
        +resource_type_filter?: SearchResourceFilter[]
        +search_recency_filter?: string
    }
    
    class SearchResponse {
        +data: object
        +status: number
        +msg: string
    }
    
    App --> Header
    App --> HomePage
    App --> NewsDetailPage
    HomePage --> CategorySidebar
    HomePage --> SearchBar
    HomePage --> FilterBar
    HomePage --> NewsCard
    HomePage --> API
    NewsDetailPage --> API
    API --> SearchRequest
    API --> SearchResponse
    HomePage --> NewsItem
    NewsDetailPage --> NewsItem
    NewsCard --> NewsItem
```

## 2. 新闻获取流程时序图

```mermaid
sequenceDiagram
    participant User as 用户
    participant HomePage as 首页组件
    participant API as API服务
    participant BaiduSearch as 百度搜索接口
    
    User->>HomePage: 选择新闻分类
    activate HomePage
    HomePage->>HomePage: 更新selectedCategory
    HomePage->>API: searchNews(request)
    activate API
    API->>BaiduSearch: POST /v2/ai_search/chat/completions
    activate BaiduSearch
    BaiduSearch-->>API: 返回搜索结果
    deactivate BaiduSearch
    API-->>HomePage: SearchResponse
    deactivate API
    HomePage->>HomePage: 转换为NewsItem[]
    HomePage->>HomePage: 更新newsList
    HomePage-->>User: 显示新闻列表
    deactivate HomePage
```

## 3. 新闻详情查看流程时序图

```mermaid
sequenceDiagram
    participant User as 用户
    participant HomePage as 首页组件
    participant NewsDetailPage as 详情页组件
    participant API as API服务
    participant WebSummary as 网页总结接口
    
    User->>HomePage: 点击新闻卡片
    activate HomePage
    HomePage->>NewsDetailPage: navigate('/news/:id', {state: {news}})
    deactivate HomePage
    activate NewsDetailPage
    NewsDetailPage->>NewsDetailPage: 显示新闻详情
    NewsDetailPage->>API: summarizeWeb(request)
    activate API
    API->>WebSummary: POST /webSummary
    activate WebSummary
    WebSummary-->>API: 返回摘要内容
    deactivate WebSummary
    API-->>NewsDetailPage: WebSummaryResponse
    deactivate API
    NewsDetailPage->>NewsDetailPage: 更新summary
    NewsDetailPage-->>User: 显示完整新闻和摘要
    deactivate NewsDetailPage
```

## 4. 搜索功能流程时序图

```mermaid
sequenceDiagram
    participant User as 用户
    participant SearchBar as 搜索栏组件
    participant HomePage as 首页组件
    participant API as API服务
    participant BaiduSearch as 百度搜索接口
    
    User->>SearchBar: 输入搜索关键词
    User->>SearchBar: 点击搜索按钮
    activate SearchBar
    SearchBar->>SearchBar: handleSubmit()
    SearchBar->>HomePage: onSearch(query)
    deactivate SearchBar
    activate HomePage
    HomePage->>HomePage: 更新searchQuery
    HomePage->>API: searchNews(request)
    activate API
    API->>BaiduSearch: POST 搜索请求
    activate BaiduSearch
    BaiduSearch-->>API: 返回搜索结果
    deactivate BaiduSearch
    API-->>HomePage: SearchResponse
    deactivate API
    HomePage->>HomePage: 更新newsList
    HomePage-->>User: 显示搜索结果
    deactivate HomePage
```

## 5. 组件层次结构图

```mermaid
graph TD
    A[App] --> B[Header]
    A --> C[HomePage]
    A --> D[NewsDetailPage]
    
    B --> B1[Logo]
    B --> B2[ModeToggle]
    
    C --> C1[CategorySidebar]
    C --> C2[SearchBar]
    C --> C3[FilterBar]
    C --> C4[NewsCard List]
    
    C4 --> C4a[NewsCard 1]
    C4 --> C4b[NewsCard 2]
    C4 --> C4c[NewsCard N]
    
    D --> D1[新闻标题]
    D --> D2[新闻元信息]
    D --> D3[操作按钮]
    D --> D4[新闻内容]
    D --> D5[智能摘要]
    
    style A fill:#1e3a8a,color:#fff
    style C fill:#2563eb,color:#fff
    style D fill:#2563eb,color:#fff
    style B fill:#f97316,color:#fff
```

## 6. 数据流图

```mermaid
graph LR
    A[用户操作] --> B{操作类型}
    
    B -->|选择分类| C[更新分类状态]
    B -->|时间筛选| D[更新时间过滤器]
    B -->|搜索| E[更新搜索关键词]
    
    C --> F[构建搜索请求]
    D --> F
    E --> F
    
    F --> G[调用百度搜索API]
    G --> H[接收搜索结果]
    H --> I[转换为NewsItem]
    I --> J[更新新闻列表]
    J --> K[渲染新闻卡片]
    
    K --> L[用户点击新闻]
    L --> M[导航到详情页]
    M --> N[调用网页总结API]
    N --> O[显示新闻详情和摘要]
    
    style A fill:#f97316,color:#fff
    style G fill:#1e3a8a,color:#fff
    style N fill:#1e3a8a,color:#fff
    style K fill:#2563eb,color:#fff
    style O fill:#2563eb,color:#fff
```

## 7. 状态管理图

```mermaid
stateDiagram-v2
    [*] --> 初始化
    初始化 --> 加载中: 发起API请求
    加载中 --> 显示新闻: 请求成功
    加载中 --> 错误状态: 请求失败
    显示新闻 --> 加载中: 切换分类/筛选
    显示新闻 --> 新闻详情: 点击新闻
    新闻详情 --> 加载摘要: 获取摘要
    加载摘要 --> 显示完整详情: 摘要加载成功
    加载摘要 --> 显示基本详情: 摘要加载失败
    显示完整详情 --> 显示新闻: 返回列表
    显示基本详情 --> 显示新闻: 返回列表
    错误状态 --> 加载中: 重试
    错误状态 --> 显示新闻: 返回
```

## 8. API交互架构图

```mermaid
graph TB
    subgraph 前端应用
        A[React组件]
        B[API工具层]
        C[Axios客户端]
    end
    
    subgraph API网关
        D[API集成服务]
    end
    
    subgraph 第三方服务
        E[百度搜索API]
        F[网页总结API]
    end
    
    A -->|调用| B
    B -->|HTTP请求| C
    C -->|POST请求| D
    D -->|转发| E
    D -->|转发| F
    E -->|搜索结果| D
    F -->|摘要内容| D
    D -->|响应| C
    C -->|返回数据| B
    B -->|更新状态| A
    
    style A fill:#2563eb,color:#fff
    style D fill:#1e3a8a,color:#fff
    style E fill:#f97316,color:#fff
    style F fill:#f97316,color:#fff
```

## 说明

### 主要组件职责

1. **App**: 应用根组件，管理路由和全局布局
2. **Header**: 顶部导航栏，包含Logo和主题切换
3. **HomePage**: 首页，展示新闻列表和筛选功能
4. **NewsDetailPage**: 新闻详情页，展示完整新闻内容和智能摘要
5. **CategorySidebar**: 分类侧边栏，用于切换新闻分类
6. **SearchBar**: 搜索栏，支持关键词搜索
7. **FilterBar**: 筛选栏，支持时间范围筛选
8. **NewsCard**: 新闻卡片，展示单条新闻摘要

### 数据流向

1. 用户操作 → 组件状态更新 → API请求 → 数据处理 → UI更新
2. 所有API请求通过统一的API工具层处理
3. 使用React状态管理组件内部状态
4. 通过React Router进行页面导航和状态传递

### API集成

1. **百度搜索接口**: 用于获取热点新闻列表
2. **网页总结接口**: 用于生成新闻内容的智能摘要
